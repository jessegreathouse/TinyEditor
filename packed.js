TINY={};function T$(a){return document.getElementById(a)}function T$$$(){return document.all?1:0}TINY.editor=function(){var d=[],b=-30;d.cut=[1,"Cut","a","cut",1];d.copy=[2,"Copy","a","copy",1];d.paste=[3,"Paste","a","paste",1];d.bold=[4,"Bold","a","bold"];d.italic=[5,"Italic","a","italic"];d.underline=[6,"Underline","a","underline"];d.strikethrough=[7,"Strikethrough","a","strikethrough"];d.subscript=[8,"Subscript","a","subscript"];d.superscript=[9,"Superscript","a","superscript"];d.orderedlist=[10,"Insert Ordered List","a","insertorderedlist"];d.unorderedlist=[11,"Insert Unordered List","a","insertunorderedlist"];d.outdent=[12,"Outdent","a","outdent"];d.indent=[13,"Indent","a","indent"];d.leftalign=[14,"Left Align","a","justifyleft"];d.centeralign=[15,"Center Align","a","justifycenter"];d.rightalign=[16,"Right Align","a","justifyright"];d.blockjustify=[17,"Block Justify","a","justifyfull"];d.undo=[18,"Undo","a","undo"];d.redo=[19,"Redo","a","redo"];d.image=[20,"Insert Image","i","insertimage","Enter Image URL:","http://"];d.hr=[21,"Insert Horizontal Rule","a","inserthorizontalrule"];d.link=[22,"Insert Hyperlink","i","createlink","Enter URL:","http://"];d.unlink=[23,"Remove Hyperlink","a","unlink"];d.unformat=[24,"Remove Formatting","a","removeformat"];d.print=[25,"Print","a","print"];function a(G,z){this.n=G;window[G]=this;this.t=T$(z.id);this.obj=z;this.xhtml=z.xhtml;var D=document.createElement("div"),y=document.createElement("div"),M=document.createElement("div"),J=z.controls.length,K=0;this.i=document.createElement("iframe");this.i.frameBorder=0;this.i.width=z.width||"100%";this.i.height=z.height||"250";this.ie=T$$$();M.className=z.rowclass||"teheader";D.className=z.cssclass||"te";D.style.width=this.i.width+"px";D.appendChild(M);for(K;K<J;K++){var E=z.controls[K];if(E=="n"){M=document.createElement("div");M.className=z.rowclass||"teheader";D.appendChild(M)}else{if(E=="|"){var R=document.createElement("div");R.className=z.dividerclass||"tedivider";M.appendChild(R)}else{if(E=="font"){var I=document.createElement("select"),s=z.fonts||["Verdana","Arial","Georgia"],t=s.length,v=0;I.className="tefont";I.onchange=new Function(this.n+'.ddaction(this,"fontname")');I.options[0]=new Option("Font","");for(v;v<t;v++){var B=s[v];I.options[v+1]=new Option(B,B)}M.appendChild(I)}else{if(E=="size"){var I=document.createElement("select"),c=z.sizes||[1,2,3,4,5,6,7],Q=c.length,v=0;I.className="tesize";I.onchange=new Function(this.n+'.ddaction(this,"fontsize")');for(v;v<Q;v++){var C=c[v];I.options[v]=new Option(C,C)}M.appendChild(I)}else{if(E=="style"){var I=document.createElement("select"),k=z.styles||[["Style",""],["Paragraph","<p>"],["Header 1","<h1>"],["Header 2","<h2>"],["Header 3","<h3>"],["Header 4","<h4>"],["Header 5","<h5>"],["Header 6","<h6>"]],Q=k.length,v=0;I.className="testyle";I.onchange=new Function(this.n+'.ddaction(this,"formatblock")');for(v;v<Q;v++){var L=k[v];I.options[v]=new Option(L[0],L[1])}M.appendChild(I)}else{if(d[E]){var A=document.createElement("div"),v=d[E],o=v[2],O,q=v[0]*b;A.className=z.controlclass;A.style.backgroundPosition="0px "+q+"px";A.title=v[1];O=o=="a"?'.action("'+v[3]+'",0,'+(v[4]||0)+")":'.insert("'+v[4]+'","'+v[5]+'","'+v[3]+'")';A.onclick=new Function(this.n+(E=="print"?".print()":O));A.onmouseover=new Function(this.n+".hover(this,"+q+",1)");A.onmouseout=new Function(this.n+".hover(this,"+q+",0)");M.appendChild(A);if(this.ie){A.unselectable="on"}}}}}}}}this.t.parentNode.insertBefore(D,this.t);this.t.style.width=this.i.width+"px";y.appendChild(this.t);y.appendChild(this.i);D.appendChild(y);this.t.style.display="none";if(z.footer){var N=document.createElement("div");N.className=z.footerclass||"tefooter";if(z.toggle){var j=z.toggle,g=document.createElement("div");g.className=j.cssclass||"toggle";g.innerHTML=z.toggletext||"source";g.onclick=new Function(this.n+".toggle(0,this);return false");N.appendChild(g)}if(z.resize){var u=z.resize,r=document.createElement("div");r.className=u.cssclass||"resize";r.onmousedown=new Function("event",this.n+".resize(event);return false");r.onselectstart=function(){return false};N.appendChild(r)}D.appendChild(N)}this.e=this.i.contentWindow.document;this.e.open();var H="<html><head>",F=z.bodyid?' id="'+z.bodyid+'"':"";if(z.cssfile){H+='<link rel="stylesheet" href="'+z.cssfile+'" />'}if(z.css){H+='<style type="text/css">'+z.css+"</style>"}H+="</head><body"+F+">"+(z.content||this.t.value);H+="</body></html>";this.e.write(H);this.e.close();this.e.designMode="on";this.d=1;if(this.xhtml){try{this.e.execCommand("styleWithCSS",0,0)}catch(P){try{this.e.execCommand("useCSS",0,1)}catch(P){}}}}a.prototype.print=function(){this.i.contentWindow.print()},a.prototype.hover=function(f,e,c){f.style.backgroundPosition=(c?"34px ":"0px ")+(e)+"px"},a.prototype.ddaction=function(c,e){var g=c.selectedIndex,f=c.options[g].value;this.action(e,f)},a.prototype.action=function(c,f,e){if(e&&!this.ie){alert("Your browser does not support this function.")}else{this.e.execCommand(c,0,f||null)}},a.prototype.insert=function(g,f,c){var e=prompt(g,f);if(e!=null&&e!=""){this.e.execCommand(c,0,e)}},a.prototype.setfont=function(){execCommand("formatblock",0,hType)},a.prototype.resize=function(c){if(this.mv){this.freeze()}this.i.bcs=TINY.cursor.top(c);this.mv=new Function("event",this.n+".move(event)");this.sr=new Function(this.n+".freeze()");if(this.ie){document.attachEvent("onmousemove",this.mv);document.attachEvent("onmouseup",this.sr)}else{document.addEventListener("mousemove",this.mv,1);document.addEventListener("mouseup",this.sr,1)}},a.prototype.move=function(c){var f=TINY.cursor.top(c);this.i.height=parseInt(this.i.height)+f-this.i.bcs;this.i.bcs=f},a.prototype.freeze=function(){if(this.ie){document.detachEvent("onmousemove",this.mv);document.detachEvent("onmouseup",this.sr)}else{document.removeEventListener("mousemove",this.mv,1);document.removeEventListener("mouseup",this.sr,1)}},a.prototype.toggle=function(e,f){if(!this.d){var c=this.t.value;if(f){f.innerHTML=this.obj.toggletext||"source"}if(this.xhtml&&!this.ie){c=c.replace(/<strong>(.*)<\/strong>/gi,'<span style="font-weight: bold;">$1</span>');c=c.replace(/<em>(.*)<\/em>/gi,'<span style="font-weight: italic;">$1</span>')}this.e.body.innerHTML=c;this.t.style.display="none";this.i.style.display="block";this.d=1}else{var c=this.e.body.innerHTML;if(this.xhtml){c=c.replace(/<span class="apple-style-span">(.*)<\/span>/gi,"$1");c=c.replace(/ class="apple-style-span"/gi,"");c=c.replace(/<span style="">/gi,"");c=c.replace(/<br>/gi,"<br />");c=c.replace(/<br ?\/?>$/gi,"");c=c.replace(/^<br ?\/?>/gi,"");c=c.replace(/(<img [^>]+[^\/])>/gi,"$1 />");c=c.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>");c=c.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>");c=c.replace(/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,'<span style="text-decoration:underline">$1</span>');c=c.replace(/<(b|strong|em|i|u) style="font-weight: normal;?">(.*)<\/(b|strong|em|i|u)>/gi,"$2");c=c.replace(/<(b|strong|em|i|u) style="(.*)">(.*)<\/(b|strong|em|i|u)>/gi,'<span style="$2"><$4>$3</$4></span>');c=c.replace(/<span style="font-weight: normal;?">(.*)<\/span>/gi,"$1");c=c.replace(/<span style="font-weight: bold;?">(.*)<\/span>/gi,"<strong>$1</strong>");c=c.replace(/<span style="font-style: italic;?">(.*)<\/span>/gi,"<em>$1</em>");c=c.replace(/<span style="font-weight: bold;?">(.*)<\/span>|<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>")}if(f){f.innerHTML=this.obj.toggletext||"wysiwyg"}this.t.value=c;if(!e){this.t.style.height=this.i.height+"px";this.i.style.display="none";this.t.style.display="block";this.d=0}}},a.prototype.post=function(){if(this.d){this.toggle(1)}};return{edit:a}}();TINY.cursor=function(){return{top:function(a){return T$$$()?window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop:a.clientY+window.scrollY}}}();